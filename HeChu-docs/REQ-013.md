# REQ-013: 优化原型的调试图生成 - 识别区域叠加图

## 状态
- [ ] 待开发
- [ ] 开发中
- [x] 已完成

## 创建信息
- 创建时间: 2026-02-12
- 最后更新: 2026-02-12
- 优先级: 高（紧急）

## 需求描述
新增生成一张调试图片，展示识别结果：
1. 将原图亮度降低一半（作为暗化背景）
2. 在暗化背景上框选出所有识别区域（网格、元件、需求条、锁格等实际参与计算的区域）
3. 叠加元件和需求条的二值化识别结果，使用对应的 HSV 颜色

此调试图用于直观展示算法识别出的所有区域，方便验证识别准确性和调试问题。

## 边界条件
无特殊情况

## 技术路线
1. 在 `detect.py` 的调试输出流程中新增一个步骤（建议在 `_debug_save` 之后）
2. 创建新函数生成复合调试图：
   - 将原图亮度减半：`img = img * 0.5`
   - 用不同颜色的边框标出各区域（网格用绿色、元件用蓝色、锁定格用黄色、需求条用红色/绿色）
   - 为元件和需求条生成二值化 mask（使用对应的 HSV 颜色和相似度算法）
   - 将二值化 mask 转换为对应颜色并叠加到图像上
3. 保存为调试输出目录中的新文件（如 `5_all_regions.png`）
4. 保持与现有调试图的命名风格一致

## 参考
参考现有的 `_debug_save` 函数和其他调试图生成逻辑（如 `1_grid_matches.png`、`4_comp_mask.png` 等）

## 相关文件
- `prototype/detect.py` - 新增 `_generate_region_overlay` 函数，在 detect 流程中调用生成 5_all_regions.png
